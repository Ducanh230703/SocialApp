@model Models.ViewModel.Chat.ChatMessageVM

<div class="chat-box" data-user-id="@Model.TargetUserId" id="chat-box-@Model.TargetUserId">
    <div class="chat-box-header">
        <div class="friend-info">
            <img src="@(string.IsNullOrEmpty(Model.TargetUserProfilePictureUrl) ? "/images/default_avatar.png" : Model.TargetUserProfilePictureUrl)" alt="@Model.TargetUserFullName" class="avatar">
            <span class="friend-name">@Model.TargetUserFullName</span>
        </div>
        <div class="chat-box-actions">
            <button class="minimize-btn" data-uk-icon="icon: minus"></button>
            <button class="video-call-btn" data-uk-icon="icon: video-camera"></button>
            <button class="close-btn" data-uk-icon="icon: close"></button>
        </div>
    </div>
    <div class="chat-box-messages" id="chat-messages-@Model.TargetUserId">
        @if (Model.Messages != null && Model.Messages.Data != null && Model.Messages.Data.Any())
        {
            @foreach (var message in Model.Messages.Data.OrderBy(m => m.SentDate)) // Sắp xếp tin nhắn theo thời gian
            {
                <div class="message-item @(message.SenderId == Model.CurrentLoggedInUserId ? "sent" : "received")">
                    <div class="message-content">@message.Content</div>
                </div>
            }
        }
        else
        {
            <p class="uk-text-muted uk-text-small uk-text-center">Chưa có tin nhắn nào.</p>
        }
    </div>
    <div class="chat-box-input">
        <input type="text" placeholder="Nhập tin nhắn..." id="chat-input-@Model.TargetUserId">
        <button id="send-button-@Model.TargetUserId" data-uk-icon="icon: paper-plane"></button>
    </div>
</div>